# 数据增强 data augmentation

通过技术手段对已有数据进行补充，起到扩大数据集，增强模型鲁棒性的目的

数据增强手段在图像方面的增强，被称为**图像增强**

**图像增强**的方法有:

1. **几何变换**
   - **旋转**：随机旋转图像一定角度。
   - **平移**：在水平方向或垂直方向上平移图像。
   - **缩放**：随机放大或缩小图像。
   - **翻转**：水平或垂直翻转图像。
   - **剪切**：对图像进行剪切变换，使其发生倾斜。

2. **颜色变换**
   - **亮度调整**：改变图像的亮度，使其变亮或变暗。
   - **对比度调整**：增强或减弱图像的对比度。
   - **饱和度调整**：增加或减少图像的色彩饱和度。
   - **色调调整**：改变图像的整体色调。

3. **图像滤波**
   - **模糊处理**：应用高斯模糊、均值模糊等，使图像变得模糊。
   - **锐化处理**：增强图像的边缘，使其变得更清晰。
   - **去噪处理**：使用中值滤波、双边滤波等方法去除图像中的噪声。

4. **随机擦除**
   - 随机在图像上擦除一块区域，用于增加模型的鲁棒性。

5. **仿射变换**
   - 通过仿射矩阵对图像进行变换，如旋转、缩放、平移和剪切的组合。

6. **图像增强技术**
   - **直方图均衡化**：调整图像的直方图分布，使其更均匀。
   - **自适应直方图均衡化**：在小窗口内进行直方图均衡化，以提高局部对比度。
   - **CLAHE（对比度受限自适应直方图均衡化）**：防止过度增强带来的噪声。

7. **数据增广**
   - 通过组合上述各种方法，生成更多的训练数据，增加模型的泛化能力。


除此以外还有以下数据增强:

1. **文本数据增强**
   - **同义词替换**：用同义词替换文本中的某些词语。
   - **随机插入**：在文本中随机插入一些词语。
   - **随机删除**：随机删除文本中的一些词语。
   - **随机交换**：随机交换文本中的某些词语。
   - **回译**：将文本翻译成另一种语言，再翻译回原始语言，以生成不同版本的文本。

2. **时间序列数据增强**
   - **加噪声**：在时间序列数据中添加随机噪声。
   - **时间偏移**：对时间序列数据进行小幅度的时间偏移。
   - **缩放**：对时间序列数据进行纵向或横向的缩放。
   - **时间反转**：将时间序列数据反转，改变其时间顺序。
   - **随机采样**：对时间序列数据进行随机采样，生成新的序列。

3. **语音数据增强**
   - **添加背景噪声**：在语音数据中添加背景噪声。
   - **时间拉伸**：改变语音数据的播放速度。
   - **音调变化**：改变语音数据的音调。
   - **随机裁剪**：随机裁剪语音数据的一部分。
   - **混合增强**：将不同的语音数据混合在一起。

4. **表格数据增强**
   - **数值扰动**：对数值数据添加微小的扰动。
   - **类别转换**：对于分类数据，随机替换为同类中的其他值。
   - **合成数据**：使用生成对抗网络（GANs）等方法生成新的合成数据。
   - **数据平滑**：通过平滑技术减少数据的噪声。

5. **图形和图表数据增强**
   - **随机删除节点或边**：在图数据中随机删除节点或边。
   - **节点或边属性扰动**：对节点或边的属性添加随机扰动。
   - **子图采样**：从图数据中采样生成子图。

6. **传感器数据增强**
   - **传感器噪声添加**：在传感器数据中添加噪声。
   - **信号漂移**：模拟传感器信号的漂移。
   - **信号翻转**：将信号数据翻转，改变其顺序。

## 图像增强

图像增强分为实时和预保存（其他类型数据增强也类似）

1. **实时图像增强**
这种方法是在训练过程中动态地对图像进行增强，而不保存增强后的图像。

   - 优点：
      - 节省存储空间：无需保存大量增强后的图像，节省存储空间。
      - 多样性：每次训练时增强操作都可能不同，提高数据的多样性。
      - 灵活性：可以根据需要动态调整增强策略和参数。
   - 缺点：
     - 训练速度：实时增强需要在训练过程中进行图像处理，可能会影响训练速度，特别是在增强操作较复杂时。
   - 适用场景：
     - 数据量较大，存储空间有限。
     - 需要频繁调整或实验不同的增强策略。
     - 使用具有高效数据加载和增强功能的框架，如TensorFlow、PyTorch等。
2. **预先增强并保存图像**
这种方法是在训练之前对图像进行增强，并将增强后的图像保存下来。

   - 优点：
     - 训练速度快：在训练时直接加载增强后的图像，不需要额外的图像处理时间。
     - 可重复性：每次训练使用相同的增强图像，结果更具可重复性。
   - 缺点：
     - 存储需求大：需要大量的存储空间来保存所有增强后的图像。
     - 缺乏多样性：增强后的图像固定，可能降低数据多样性。
   - 适用场景：
     - 数据量较小，存储空间充足。
     - 增强策略固定且不需要频繁调整。
     - 需要快速迭代训练模型。

还可以通过仿射变换来进行图像的旋转、缩放、平移、剪切操作，原理参考[这里](https://www.bilibili.com/video/BV1254y1h7R7/?vd_source=e3e6bb1b164806ab40cbadaa22f05b43)

已经有很多丰富的库实现了数据增强的功能，例如: pytorch 的 torchvision.transforms 已经实现了图像增强

请参考[示例代码](./示例代码/数据增强.py)

## 其他数据增强库

[用于数据增强的十个Python库](https://www.51cto.com/article/768789.html)

[How To Implement Data Augmentation In Python [Image & Text]](https://spotintelligence.com/2023/03/09/data-augmentation-python-image-text-nlp/)

[Data Augmentation in Python: Everything You Need to Know](https://neptune.ai/blog/data-augmentation-in-python)